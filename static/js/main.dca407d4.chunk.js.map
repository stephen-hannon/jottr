{"version":3,"sources":["hooks.ts","Storage.ts","styles/flex.ts","components/Note.tsx","components/NoteList.tsx","utils.ts","components/Header.tsx","App.tsx","index.tsx"],"names":["useStoredState","storage","key","defaultValue","useState","getItem","value","setValue","useEffect","setItem","LocalStorage","namespace","this","window","localStorage","toString","getNamespacedKey","undefined","JSON","parse","removeItem","stringifiedValue","stringify","flexRow","css","flexChild","NoteWrapper","styled","div","Header","Title","input","theme","duration","colors","gray","primary","Body","textarea","Note","data","deleteDisabled","moveUpDisabled","moveDownDisabled","onDelete","onMove","onChange","textRef","useRef","textHeight","setTextHeight","current","console","log","scrollHeight","Math","max","text","title","target","placeholder","disabled","onClick","ref","style","height","EMPTY_NOTE_DATA","reducer","state","action","type","newData","parameter","getInitialState","keys","forEach","NoteList","setKeys","nextKey","setNextKey","useReducer","dispatch","makeOnMove","index","direction","arr","fromInd","toInd","length","newArr","splice","move","map","filter","k","HeaderWrapper","h1","Nav","ul","NavItem","li","role","href","THEME","primaryLight","App","rootElement","document","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.dca407d4.chunk.js","sourcesContent":["import { useEffect, useState, Dispatch, SetStateAction } from 'react';\nimport LocalStorage from './Storage';\n\nexport function useStoredState<T>(\n  storage: LocalStorage,\n  key: string,\n  defaultValue: T\n): [T, Dispatch<SetStateAction<T>>] {\n  const [value, setValue] = useState<T>(() => {\n    return storage.getItem(key, defaultValue);\n  });\n\n  useEffect(() => {\n    storage.setItem(key, value);\n  }, [storage, key, value]);\n\n  return [value, setValue];\n}\n","// import { useEffect, useState } from 'react';\n\ntype KeyType = string | number;\n\nexport default class LocalStorage {\n  private namespace?: string;\n  private storage: Storage;\n\n  constructor(namespace?: string) {\n    this.namespace = namespace;\n    this.storage = window.localStorage;\n  }\n\n  getNamespacedKey(key: KeyType): string {\n    return this.namespace ? `${this.namespace}_${key}` : key.toString();\n  }\n\n  getItem<T>(key: KeyType, defaultValue?: T) {\n    const value = this.storage.getItem(this.getNamespacedKey(key));\n    return value === null && defaultValue !== undefined\n      ? defaultValue\n      : JSON.parse(value as string);\n  }\n\n  removeItem(key: KeyType) {\n    this.storage.removeItem(this.getNamespacedKey(key));\n  }\n\n  setItem(key: KeyType, value: unknown) {\n    const stringifiedValue = JSON.stringify(value);\n    this.storage.setItem(this.getNamespacedKey(key), stringifiedValue);\n  }\n\n  // useStoredState(key, defaultValue) {\n  //   const [value, setValue] = useState(() => {\n  //     return this.getItem(key, defaultValue);\n  //   });\n\n  //   useEffect(() => {\n  //     this.setItem(key, value);\n  //   }, [key, value]);\n\n  //   return [value, setValue];\n  // }\n}\n","import { css } from 'styled-components';\n\nexport const flexRow = css`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nexport const flexChild = css`\n  flex: 1;\n`;\n","import React, { useRef, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport { flexRow } from 'styles/flex';\n\nconst MIN_BODY_HEIGHT = 150;\n\nconst NoteWrapper = styled.div`\n  border-radius: 10px;\n  box-shadow: 0 0 6px 0 #00000080;\n  margin: 4rem auto;\n  padding: 2rem;\n  max-width: 1000px;\n`;\n\nconst Header = styled.div`\n  ${flexRow}\n`;\n\nconst Title = styled.input`\n  display: block;\n  width: 100%;\n  border: none;\n  font-weight: bold;\n  font-size: 2rem;\n  border-bottom: 2px solid transparent;\n  transition: border-bottom-color linear ${({ theme }) => theme.duration}s;\n\n  &:hover {\n    border-bottom-color: ${({ theme }) => theme.colors.gray};\n  }\n\n  &:focus {\n    outline: none;\n    border-bottom-color: ${({ theme }) => theme.colors.primary};\n  }\n`;\n\nconst Body = styled.textarea`\n  font-family: 'Source Code Pro', Consolas, Monaco, monospace;\n  display: block;\n  width: 100%;\n  margin-top: 1.5rem;\n\n  &:not(:focus) {\n    height: ${MIN_BODY_HEIGHT}px !important;\n  }\n`;\n\ninterface ComponentProps {\n  data: {\n    title: string;\n    text: string;\n  };\n  deleteDisabled?: boolean;\n  moveUpDisabled?: boolean;\n  moveDownDisabled?: boolean;\n  onDelete?: (event: React.MouseEvent) => void;\n  onMove: (delta: number) => void;\n  onChange: (parameter: string, newValue: string) => void;\n}\n\nconst Note: React.FC<ComponentProps> = ({\n  data,\n  deleteDisabled,\n  moveUpDisabled,\n  moveDownDisabled,\n  onDelete,\n  onMove,\n  onChange,\n}) => {\n  const textRef = useRef<HTMLTextAreaElement>(null);\n  const [textHeight, setTextHeight] = useState<number>(150);\n\n  useEffect(() => {\n    if (!textRef.current) return;\n\n    console.log(textRef.current.scrollHeight);\n    setTextHeight(Math.max(textRef.current.scrollHeight, MIN_BODY_HEIGHT));\n  }, [data.text]);\n\n  return (\n    <NoteWrapper>\n      <Header>\n        <Title\n          value={data.title}\n          onChange={({ target }) => onChange('title', target.value)}\n          placeholder=\"Title\"\n        />\n        <button disabled={moveUpDisabled} onClick={() => onMove(-1)}>\n          ↑\n        </button>\n        <button disabled={moveDownDisabled} onClick={() => onMove(1)}>\n          ↓\n        </button>\n        <button disabled={deleteDisabled} onClick={onDelete}>\n          delete\n        </button>\n      </Header>\n      <Body\n        // TODO: Autofocus first textarea on page load\n        ref={textRef}\n        style={{ height: textHeight }}\n        value={data.text}\n        placeholder=\"Start typing...\"\n        onChange={({ target }) => onChange('text', target.value)}\n      />\n    </NoteWrapper>\n  );\n};\n\nexport default Note;\n","import React, { useReducer, useEffect } from 'react';\n\nimport { useStoredState } from 'hooks';\nimport { move } from 'utils';\nimport LocalStorage from 'Storage';\nimport Note from './Note';\n\nconst EMPTY_NOTE_DATA = {\n  title: '',\n  text: '',\n};\n\nconst storage = new LocalStorage('jottr');\n\ninterface NoteState {\n  [key: number]: {\n    // TODO: make this reusable\n    title: string;\n    text: string;\n  };\n}\n\ntype NoteAction =\n  | {\n      type: 'change';\n      key: number;\n      parameter: string;\n      value: string;\n    }\n  | {\n      type: 'delete';\n      key: number;\n    };\n\nfunction reducer(state: NoteState, action: NoteAction) {\n  switch (action.type) {\n    case 'change':\n      const newData = {\n        ...EMPTY_NOTE_DATA,\n        ...state[action.key],\n        [action.parameter]: action.value,\n      };\n      storage.setItem(action.key, newData);\n      return {\n        ...state,\n        [action.key]: newData,\n      };\n    case 'delete':\n      storage.removeItem(action.key);\n      const { [action.key]: _deleted, ...rest } = state;\n      return rest;\n  }\n}\n\nfunction getInitialState(keys: number[]): NoteState {\n  console.log('gis', keys);\n  const state: NoteState = {};\n  keys.forEach((key) => {\n    state[key] = storage.getItem<number>(key);\n  });\n  return state;\n}\n\nexport default function NoteList() {\n  const [keys, setKeys] = useStoredState<number[]>(storage, 'keys', []);\n  const [nextKey, setNextKey] = useStoredState(storage, 'nextKey', 0);\n  const [state, dispatch] = useReducer(reducer, keys, getInitialState);\n\n  useEffect(() => {\n    storage.setItem('version', 1); // will be helpful if the API ever changes\n  }, []);\n\n  const makeOnMove = (index: number) => (direction: number) => {\n    setKeys(move(keys, index, index + direction));\n  };\n\n  return (\n    <>\n      {[nextKey, ...keys].map((key, index) => (\n        <Note\n          key={key}\n          data={state[key] || EMPTY_NOTE_DATA}\n          moveUpDisabled={index <= 1}\n          moveDownDisabled={index === 0 || index === keys.length}\n          deleteDisabled={index === 0}\n          onMove={makeOnMove(index - 1)}\n          onChange={(parameter, value) => {\n            if (index === 0) {\n              setKeys([nextKey, ...keys]);\n              setNextKey(nextKey + 1);\n            }\n            dispatch({ type: 'change', key, value, parameter });\n          }}\n          onDelete={() => {\n            setKeys(keys.filter((k) => k !== key));\n            dispatch({ type: 'delete', key });\n          }}\n        />\n      ))}\n    </>\n  );\n}\n","export function move<T>(arr: T[], fromInd: number, toInd: number): T[] {\n  if (toInd < 0 || toInd >= arr.length) return arr;\n\n  const newArr = [...arr];\n  const value = newArr.splice(fromInd, 1)[0];\n  newArr.splice(toInd, 0, value);\n  return newArr;\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { flexRow, flexChild } from 'styles/flex';\n\nconst HeaderWrapper = styled.div`\n  ${flexRow}\n  color: ${({ theme }) => theme.colors.primary};\n  padding: 1.5rem 3rem;\n`;\n\nconst Title = styled.h1`\n  ${flexChild}\n  margin: 0;\n`;\n\nconst Nav = styled.ul`\n  list-style: none;\n  padding: 0;\n  margin: 0;\n`;\n\nconst NavItem = styled.li`\n  display: inline-block;\n`;\n\nconst Header: React.FC = () => (\n  <HeaderWrapper>\n    <Title>Jottr</Title>\n    <Nav role=\"navigation\">\n      <NavItem>\n        <a href=\"https://github.com/stephen-hannon/jottr\">Source code</a>\n      </NavItem>\n    </Nav>\n  </HeaderWrapper>\n);\n\nexport default Header;\n","import React from 'react';\nimport { ThemeProvider, DefaultTheme } from 'styled-components';\n\nimport NoteList from 'components/NoteList';\nimport Header from 'components/Header';\nimport './styles.css';\n\nconst THEME: DefaultTheme = {\n  colors: {\n    gray: '#e0e0e0',\n    primary: '#ab47bc',\n    primaryLight: '#df78ef',\n    text: '#000',\n  },\n  duration: 0.1,\n};\n\nexport default function App() {\n  return (\n    <ThemeProvider theme={THEME}>\n      <>\n        <Header />\n        <NoteList />\n      </>\n    </ThemeProvider>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}